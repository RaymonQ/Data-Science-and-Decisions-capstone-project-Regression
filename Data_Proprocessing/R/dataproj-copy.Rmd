---
title: "Data3001_proj"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
##set.seed(1)
gliders<-read.csv("~/Desktop/IMOS_-_Australian_National_Facility_for_Ocean_Gliders_(ANFOG)_-_delayed_mode_glider_deployments.csv", skip = 41, header = TRUE)
```



```{r}
str(gliders)
attach(gliders)
```


```{r}
#install.packages("visdat")
library("visdat")
library(dplyr)

library(gamlss)
library(gamlss.dist)
library(gamlss.add)
library("MASS")
library("goftest")
library(fitdistrplus)
library("corrplot")
```
Missing data distribution
```{r}
gliders%>%
  sample_n(100000) %>%
  vis_miss(warn_large_data = FALSE)
```

We check the data and delete the invalid data
```{r}
#library(dplyr)
#count(PSAL >= 2 & PSAL <= 41)
gliders_valid<-gliders[(PSAL >= 2 & PSAL <= 41),]
#count(gliders_valid$CPHL>= 0&gliders_valid$CPHL<=100)
gliders_valid<-gliders_valid[(gliders_valid$CPHL>= 0&gliders_valid$CPHL<=100),]
#count(gliders_valid$CDOM >=0 & gliders_valid$CDOM <= 400)
gliders_valid<-gliders_valid[(gliders_valid$CDOM>=0& gliders_valid$CDOM <= 400),]
#count(gliders_valid$VBSC>=0& gliders_valid$VBSC <= 0.1)
gliders_valid<-gliders_valid[(gliders_valid$VBSC>=0 & gliders_valid$VBSC <= 0.1),]
#count(gliders_valid$IRRAD555>=0& gliders_valid$IRRAD555 <= 1000)
gliders_valid<-gliders_valid[(gliders_valid$IRRAD555>=0& gliders_valid$IRRAD555 <= 1000),]

```


We look at the distribution.

```{r}
plotdist(gliders_valid$CPHL)
```
```{r}
#install.packages("fitdistrplus")
#library(ggplot2)
summary(gliders_valid$CPHL)
plot(density(gliders_valid$CPHL, na.rm = TRUE), xlim = c(0,2))
CPHL_positive <- gliders_valid[(gliders_valid$CPHL >0),]
CPHL_positive_value <- CPHL_positive$CPHL
fit_CPHL<-fitdistr(na.omit(CPHL_positive_value), "gamma") 
rand.gamma <- rgamma(100000,
shape = fit_CPHL$estimate[1],
rate = fit_CPHL$estimate[2])
lines(density(rand.gamma),col="red")

```



```{r}
CPHL_value<-na.omit(CPHL_positive_value)
CPHL_vector<-c(CPHL_value)
descdist(CPHL_vector,boot = 100, discrete = FALSE)
```
p-value is too small, reject the hypothesis
```{r}
fit_CPHL<-fitdist(CPHL_vector, "gamma") 
plot(fit_CPHL)
cvm.test(na.omit(CPHL_positive_value),"pgamma",shape = fit_CPHL$estimate[1],rate = fit_CPHL$estimate[2])
```

too small, therefore not a beta distribution
```{r}
fit_CPHL_beta<-fitdist(CPHL_vector/100, "beta") 
plot(fit_CPHL_beta)
cvm.test(na.omit(CPHL_positive_value),"pbeta",shape1 = fit_CPHL_beta$estimate[1],shape2 = fit_CPHL_beta$estimate[2])
```
Too small, not a normal distribution
```{r}
ks.test(CPHL_vector,"pnorm")
```
```{r}
ks.test(CPHL_vector,"dlnorm")
```
```{r}
ks.test(CPHL_vector,"pbinom")
```
```{r}
ks.test(CPHL_vector,"plogis")
```



```{r}
fit <- fitDist(CPHL_vector, k = 2, type = "realplus", trace = FALSE, try.gamlss = TRUE)
#summary(fit)
```

We will then look at the correlation 
```{r}

cor_gliders<-gliders_valid[,c(10,12,14,16,18,20,22,24,26,28,30,32,34,36,44,50,52,54,56)]
cor_gliders<-na.omit(cor_gliders)
cor(cor_gliders)
corrplot(corr=cor(cor_gliders),method = "color",tl.col="black")
```
```{r}
hist(gliders_valid$TIME_quality_control) # all good data
hist(gliders_valid$LATITUDE_quality_control) # 1.5% good data, rest are Interpolated value
hist(gliders_valid$LONGITUDE_quality_control) # 1.5% good data, rest are Interpolated value
hist(gliders_valid$PRES_quality_control) # all good data
hist(gliders_valid$DEPTH_quality_control)# all good data
hist(gliders_valid$PROFILE_quality_control) # all No QC performed data
hist(gliders_valid$PHASE_quality_control)# all No QC performed data
hist(gliders_valid$TEMP_quality_control)# all good data
hist(gliders_valid$PSAL_quality_control)# all good data
hist(gliders_valid$DOX1_quality_control)# all good data
hist(gliders_valid$DOX2_quality_control)# 81% good data, 11.3% Bad data that are potentially correctable, 8% Missing value
hist(gliders_valid$CPHL_quality_control)# all good data
hist(gliders_valid$CDOM_quality_control)# all good data
hist(gliders_valid$CNDC_quality_control)# all good data
hist(gliders_valid$VBSC_quality_control)# 86% good data, 9% Bad data that are potentially correctable, 5% bad data
hist(gliders_valid$UCUR_quality_control)#  missing value
hist(gliders_valid$VCUR_quality_control)#  missing value
hist(gliders_valid$HEAD_quality_control)# 99.9% No QC performed data
hist(gliders_valid$UCUR_GPS_quality_control)# missing value
hist(gliders_valid$VCUR_GPS_quality_control)# missing value
hist(gliders_valid$IRRAD443_quality_control) # 55%  good data, 45%  bad data
hist(gliders_valid$IRRAD490_quality_control) # 55%  good data, 45%  bad data
hist(gliders_valid$IRRAD555_quality_control) # 55%  good data, 45%  bad data
hist(gliders_valid$IRRAD670_quality_control) # 55%  good data, 45%  bad data
```

```{r}
table(gliders_valid$LATITUDE_quality_control)
23701/(23701+1562349+366)
366/(23701+1562349+366)
```


```{r}
table(gliders_valid$LONGITUDE_quality_control)
```


```{r}
table(gliders_valid$PRES_quality_control)
```


```{r}
table(gliders_valid$PROFILE_quality_control)
```


```{r}
table(gliders_valid$PHASE_quality_control)
```


```{r}
table(gliders_valid$DOX2_quality_control)# almost good data
126885/(1930+1277617+179281+703+126885)
```


```{r}
table(gliders_valid$VBSC_quality_control)# almost good data
76475/(2230+1368673+139038+76475)
```


```{r}
table(gliders_valid$UCUR_quality_control)
table(gliders_valid$VCUR_quality_control)
```

```{r}
table(gliders_valid$HEAD_quality_control)
1584749/(1584749+1667)
```


```{r}
table(gliders_valid$UCUR_GPS_quality_control)
table(gliders_valid$VCUR_GPS_quality_control)
```

```{r}
table(gliders_valid$IRRAD443_quality_control)
```

```{r}
table(gliders_valid$IRRAD490_quality_control)
```


```{r}
table(gliders_valid$IRRAD555_quality_control)
```
```{r}
table(gliders_valid$IRRAD670_quality_control)
```



```{r}
plot(gliders_valid$TEMP,gliders_valid$CPHL)
plot(gliders_valid$PRES,gliders_valid$CPHL)
plot(gliders_valid$DEPTH,gliders_valid$CPHL)
plot(gliders_valid$PSAL,gliders_valid$CPHL)
plot(gliders_valid$LATITUDE,gliders_valid$CPHL)
plot(gliders_valid$LONGITUDE,gliders_valid$CPHL)
plot(gliders_valid$PROFILE,gliders_valid$CPHL)
plot(gliders_valid$PHASE,gliders_valid$CPHL)
plot(gliders_valid$DOX1,gliders_valid$CPHL)
```

```{r}
plot(gliders_valid$DOX2,gliders_valid$CPHL)
plot(gliders_valid$CDOM,gliders_valid$CPHL)
plot(gliders_valid$CNDC,gliders_valid$CPHL)
plot(gliders_valid$VBSC,gliders_valid$CPHL)
plot(gliders_valid$HEAD,gliders_valid$CPHL)
plot(gliders_valid$IRRAD443,gliders_valid$CPHL)
plot(gliders_valid$IRRAD555,gliders_valid$CPHL)
plot(gliders_valid$IRRAD490,gliders_valid$CPHL)

```
